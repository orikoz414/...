# -*- coding: utf-8 -*-
"""Untitled0.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Zl1FVbN33vrhEnhLKpET4a0TIlsp7VNv
"""

# üìå –ü–†–û–ì–†–ê–ú–ú–ê –î–õ–Ø –ü–†–û–ì–ù–û–ó–ê –£–°–ü–ï–í–ê–ï–ú–û–°–¢–ò –°–¢–£–î–ï–ù–¢–û–í
# –≠—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞:
# 1. –°–ø—Ä–∞—à–∏–≤–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –≤—ã —Ö–æ—Ç–∏—Ç–µ –≤–≤–µ—Å—Ç–∏
# 2. –ü—Ä–æ—Å–∏—Ç –≤–≤–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ
# 3. –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ—Ç, –∫—Ç–æ –≤ –≥—Ä—É–ø–ø–µ —Ä–∏—Å–∫–∞
# 4. –°—Ç—Ä–æ–∏—Ç –ø–æ–Ω—è—Ç–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏
# 5. –î–∞—ë—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
# –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π, –∫—É—Ä–∞—Ç–æ—Ä–æ–≤, –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –°–ü–û

# üîß –®–ê–ì 1: –ü–æ–¥–∫–ª—é—á–∞–µ–º "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã" (–±–∏–±–ª–∏–æ—Ç–µ–∫–∏)
import pandas as pd  # –î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ (–∫–∞–∫ Excel)
import numpy as np   # –î–ª—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ –∏ —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª
import matplotlib.pyplot as plt  # –î–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
import seaborn as sns            # –î–ª—è –∫—Ä–∞—Å–∏–≤—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤
from sklearn.ensemble import RandomForestClassifier  # "–£–º–Ω—ã–π" –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∞
from sklearn.model_selection import train_test_split # –î–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫—É

# üé® –®–ê–ì 2: –ù–∞—Å—Ç—Ä–æ–∏–º –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥ –≥—Ä–∞—Ñ–∏–∫–æ–≤ (—á—Ç–æ–±—ã –±—ã–ª–æ –∫—Ä–∞—Å–∏–≤–æ)
plt.rcParams['font.size'] = 12          # –†–∞–∑–º–µ—Ä —Ç–µ–∫—Å—Ç–∞
plt.rcParams['axes.titlesize'] = 14     # –†–∞–∑–º–µ—Ä –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
plt.rcParams['axes.labelsize'] = 12     # –†–∞–∑–º–µ—Ä –ø–æ–¥–ø–∏—Å–µ–π –æ—Å–µ–π
sns.set_style("whitegrid")              # –°–µ—Ç–∫–∞ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö

# üìö –®–ê–ì 3: –°–æ–∑–¥–∞—ë–º "–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ" ‚Äî –ø—Ä–∏–º–µ—Ä—ã –ø—Ä–æ—à–ª—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
# –≠—Ç–æ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –º–æ–¥–µ–ª—å "–Ω–∞—É—á–∏–ª–∞—Å—å" –æ—Ç–ª–∏—á–∞—Ç—å —É—Å–ø–µ—à–Ω—ã—Ö –æ—Ç —Ç–µ—Ö, –∫—Ç–æ –≤ —Ä–∏—Å–∫–µ
np.random.seed(42)  # –§–∏–∫—Å–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å (—á—Ç–æ–±—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–≤—Ç–æ—Ä—è–ª–∏—Å—å)
n_hist = 500  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ "—Å—Ç–∞—Ä—ã—Ö" —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è

# –°–æ–∑–¥–∞—ë–º —Ç–∞–±–ª–∏—Ü—É —Å 500 —Å—Ç—É–¥–µ–Ω—Ç–∞–º–∏ –∏ —Å–ª—É—á–∞–π–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:
data = pd.DataFrame({
    '–ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å': np.random.uniform(40, 100, n_hist),   # % –ø–æ—Å–µ—â–µ–Ω–∏—è –ø–∞—Ä (40‚Äì100%)
    '—Å—Ä–µ–¥–Ω—è—è_–æ—Ü–µ–Ω–∫–∞': np.random.uniform(2.5, 5.0, n_hist), # –°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª (2.5‚Äì5.0)
    '–≤–Ω–µ—É—á–µ–±–∫–∞': np.random.choice([0, 1], n_hist),         # 1 ‚Äî —É—á–∞—Å—Ç–≤—É–µ—Ç, 0 ‚Äî –Ω–µ—Ç
    '–º–æ—Ç–∏–≤–∞—Ü–∏—è': np.random.randint(1, 11, n_hist),         # –û—Ç 1 (–ø–ª–æ—Ö–æ) –¥–æ 10 (–æ—Ç–ª–∏—á–Ω–æ)
    '–æ–ø–æ–∑–¥–∞–Ω–∏—è': np.random.poisson(3, n_hist)              # –û–ø–æ–∑–¥–∞–Ω–∏–π –∑–∞ —Å–µ–º–µ—Å—Ç—Ä (–≤ —Å—Ä–µ–¥–Ω–µ–º 3)
})

# üßÆ –®–ê–ì 4: –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫—Ç–æ —É—Å–ø–µ—à–µ–Ω
# –ú—ã "–æ—Ü–µ–Ω–∏–≤–∞–µ–º" —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø–æ —Ñ–æ—Ä–º—É–ª–µ:
# + –∑–∞ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å, –æ—Ü–µ–Ω–∫–∏, –º–æ—Ç–∏–≤–∞—Ü–∏—é, –≤–Ω–µ—É—á–µ–±–∫—É
# - –∑–∞ –æ–ø–æ–∑–¥–∞–Ω–∏—è
—É—Ä–æ–≤–µ–Ω—å = (data['–ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å'] * 0.3 +
           data['—Å—Ä–µ–¥–Ω—è—è_–æ—Ü–µ–Ω–∫–∞'] * 15 +
           data['–º–æ—Ç–∏–≤–∞—Ü–∏—è'] * 2 +
           data['–≤–Ω–µ—É—á–µ–±–∫–∞'] * 3 -
           data['–æ–ø–æ–∑–¥–∞–Ω–∏—è'] * 1.2)

# –ï—Å–ª–∏ —Å—Ç—É–¥–µ–Ω—Ç –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è ‚Äî –æ–Ω "—É—Å–ø–µ—à–Ω—ã–π" (1), –∏–Ω–∞—á–µ ‚Äî –≤ —Ä–∏—Å–∫–µ (0)
data['—É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å'] = (—É—Ä–æ–≤–µ–Ω—å > —É—Ä–æ–≤–µ–Ω—å.median()).astype(int)

# ü§ñ –®–ê–ì 5: –û–±—É—á–∞–µ–º –º–æ–¥–µ–ª—å
# X ‚Äî –ø—Ä–∏–∑–Ω–∞–∫–∏ (–Ω–∞ –æ—Å–Ω–æ–≤–µ —á–µ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º)
# y ‚Äî —Ü–µ–ª—å (—É—Å–ø–µ—à–µ–Ω –∏–ª–∏ –≤ —Ä–∏—Å–∫–µ)
X = data.drop('—É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å', axis=1)  # –í—Å–µ –∫–æ–ª–æ–Ω–∫–∏, –∫—Ä–æ–º–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
y = data['—É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å']               # –°–∞–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 1 –∏–ª–∏ 0

# –î–µ–ª–∏–º –¥–∞–Ω–Ω—ã–µ: 80% ‚Äî –æ–±—É—á–µ–Ω–∏–µ, 20% ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# –°–æ–∑–¥–∞—ë–º "—É–º–Ω—É—é –º–æ–¥–µ–ª—å" ‚Äî —Å–ª—É—á–∞–π–Ω—ã–π –ª–µ—Å (–∫–∞–∫ 100 —ç–∫—Å–ø–µ—Ä—Ç–æ–≤ –≥–æ–ª–æ—Å—É—é—Ç)
model = RandomForestClassifier(n_estimators=100, random_state=42)
model.fit(X_train, y_train)  # –û–±—É—á–∞–µ–º –Ω–∞ 80% –¥–∞–Ω–Ω—ã—Ö

# üìä –®–ê–ì 6: –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—Å–∫–æ–ª—å–∫–æ –º–æ–¥–µ–ª—å —Ç–æ—á–Ω–∞
accuracy = (model.predict(X_test) == y_test).mean()
print(f"‚úÖ –ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞. –¢–æ—á–Ω–æ—Å—Ç—å: {accuracy:.1%}\n")

# üìù –®–ê–ì 7: –°–ø—Ä–∞—à–∏–≤–∞–µ–º —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å–∫–æ–ª—å–∫–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –æ–Ω —Ö–æ—á–µ—Ç –≤–≤–µ—Å—Ç–∏
try:
    n_new = int(input("üî¢ –°–∫–æ–ª—å–∫–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –≤—ã —Ö–æ—Ç–∏—Ç–µ –≤–≤–µ—Å—Ç–∏? "))
    if n_new <= 0:
        raise ValueError("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–æ–ª—å—à–µ –Ω—É–ª—è.")

    –Ω–æ–≤—ã–µ_—Å—Ç—É–¥–µ–Ω—Ç—ã = []  # –°–ø–∏—Å–æ–∫ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–æ–≤—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤

    print("\nüìä –í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞:\n" + "-" * 40)

    # –¶–∏–∫–ª: —Å–ø—Ä–∞—à–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞
    for i in range(n_new):
        print(f"\nüë§ –°—Ç—É–¥–µ–Ω—Ç {i + 1}")
        –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å = float(input("–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å (%) –æ—Ç 0 –¥–æ 100: "))
        —Å—Ä–µ–¥–Ω—è—è_–æ—Ü–µ–Ω–∫–∞ = float(input("–°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞ (2.0‚Äì5.0): "))
        –≤–Ω–µ—É—á–µ–±–∫–∞ = int(input("–£—á–∞—Å—Ç–≤—É–µ—Ç –≤–æ –≤–Ω–µ—É—á–µ–±–∫–µ? (1 ‚Äî –¥–∞, 0 ‚Äî –Ω–µ—Ç): "))
        –º–æ—Ç–∏–≤–∞—Ü–∏—è = int(input("–ú–æ—Ç–∏–≤–∞—Ü–∏—è (1‚Äì10): "))
        –æ–ø–æ–∑–¥–∞–Ω–∏—è = int(input("–û–ø–æ–∑–¥–∞–Ω–∏–π –∑–∞ —Å–µ–º–µ—Å—Ç—Ä: "))

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ–±—ã –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–µ–¥–µ–ª–∞—Ö
        if not (0 <= –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å <= 100):
            raise ValueError("–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç 0 –¥–æ 100")
        if not (2.0 <= —Å—Ä–µ–¥–Ω—è—è_–æ—Ü–µ–Ω–∫–∞ <= 5.0):
            raise ValueError("–°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞ –æ—Ç 2.0 –¥–æ 5.0")
        if –º–æ—Ç–∏–≤–∞—Ü–∏—è < 1 or –º–æ—Ç–∏–≤–∞—Ü–∏—è > 10:
            raise ValueError("–ú–æ—Ç–∏–≤–∞—Ü–∏—è –æ—Ç 1 –¥–æ 10")
        if –æ–ø–æ–∑–¥–∞–Ω–∏—è < 0:
            raise ValueError("–û–ø–æ–∑–¥–∞–Ω–∏—è –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏")
        if –≤–Ω–µ—É—á–µ–±–∫–∞ not in [0, 1]:
            raise ValueError("–í–Ω–µ—É—á–µ–±–∫–∞: 1 ‚Äî –¥–∞, 0 ‚Äî –Ω–µ—Ç")

        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Å—Ç—É–¥–µ–Ω—Ç–∞
        –Ω–æ–≤—ã–µ_—Å—Ç—É–¥–µ–Ω—Ç—ã.append([–ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å, —Å—Ä–µ–¥–Ω—è—è_–æ—Ü–µ–Ω–∫–∞, –≤–Ω–µ—É—á–µ–±–∫–∞, –º–æ—Ç–∏–≤–∞—Ü–∏—è, –æ–ø–æ–∑–¥–∞–Ω–∏—è])

    # üîÆ –®–ê–ì 8: –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º –¥–ª—è –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
    –Ω–æ–≤—ã–µ_—Å—Ç—É–¥–µ–Ω—Ç—ã_df = pd.DataFrame(–Ω–æ–≤—ã–µ_—Å—Ç—É–¥–µ–Ω—Ç—ã, columns=X.columns)
    –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ = model.predict_proba(–Ω–æ–≤—ã–µ_—Å—Ç—É–¥–µ–Ω—Ç—ã_df)[:, 1]  # –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É—Å–ø–µ—Ö–∞ (0‚Äì100%)
    —Å—Ç–∞—Ç—É—Å—ã = ["—É—Å–ø–µ—à–Ω—ã–π" if p >= 0.5 else "–≤ –≥—Ä—É–ø–ø–µ —Ä–∏—Å–∫–∞" for p in –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏]

    # üìã –°–æ–∑–¥–∞—ë–º —Ç–∞–±–ª–∏—Ü—É —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
    —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã = pd.DataFrame({
        '–°—Ç—É–¥–µ–Ω—Ç': [f"–°—Ç—É–¥–µ–Ω—Ç {i+1}" for i in range(n_new)],
        '–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å': –Ω–æ–≤—ã–µ_—Å—Ç—É–¥–µ–Ω—Ç—ã_df['–ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å'],
        '–°—Ä. –æ—Ü–µ–Ω–∫–∞': –Ω–æ–≤—ã–µ_—Å—Ç—É–¥–µ–Ω—Ç—ã_df['—Å—Ä–µ–¥–Ω—è—è_–æ—Ü–µ–Ω–∫–∞'],
        '–û–ø–æ–∑–¥–∞–Ω–∏—è': –Ω–æ–≤—ã–µ_—Å—Ç—É–¥–µ–Ω—Ç—ã_df['–æ–ø–æ–∑–¥–∞–Ω–∏—è'],
        '–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å': –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏,
        '–°—Ç–∞—Ç—É—Å': —Å—Ç–∞—Ç—É—Å—ã
    })

    # –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –∫–æ–Ω—Å–æ–ª—å
    print("\n" + "‚úÖ –ü–†–û–ì–ù–û–ó –î–õ–Ø –ì–†–£–ü–ü–´".center(60))
    print("-" * 60)
    print(—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã[['–°—Ç—É–¥–µ–Ω—Ç', '–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å', '–°—Ä. –æ—Ü–µ–Ω–∫–∞', '–û–ø–æ–∑–¥–∞–Ω–∏—è', '–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å', '–°—Ç–∞—Ç—É—Å']].to_string(index=False))
    print("-" * 60)

    # üìà –®–ê–ì 9: –°—Ç—Ä–æ–∏–º –î–ò–ù–ê–ú–ò–ß–ï–°–ö–ò–ï –≥—Ä–∞—Ñ–∏–∫–∏ ‚Äî –æ–Ω–∏ –º–µ–Ω—è—é—Ç—Å—è –ø–æ–¥ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ
    fig, axes = plt.subplots(2, 2, figsize=(15, 10))
    fig.suptitle(f"üìä –ê–ù–ê–õ–ò–ó –£–°–ü–ï–í–ê–ï–ú–û–°–¢–ò: {n_new} —Å—Ç—É–¥–µ–Ω—Ç–æ–≤", fontsize=16, weight='bold')

    # –ì—Ä–∞—Ñ–∏–∫ 1: –ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ ‚Äî —Å–∫–æ–ª—å–∫–æ –≤ —Ä–∏—Å–∫–µ
    —Å—Ç–∞—Ç—É—Å_counts = —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã['–°—Ç–∞—Ç—É—Å'].value_counts()
    axes[0, 0].pie(—Å—Ç–∞—Ç—É—Å_counts, labels=—Å—Ç–∞—Ç—É—Å_counts.index, autopct='%1.1f%%',
                   colors=['#4CAF50', '#F44336'], startangle=90)
    axes[0, 0].set_title("–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º")

    # –ì—Ä–∞—Ñ–∏–∫ 2: –û–ø–æ–∑–¥–∞–Ω–∏—è vs –ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å ‚Äî –≥–¥–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è —Å—Ç—É–¥–µ–Ω—Ç—ã
    —Ü–≤–µ—Ç–∞ = {'—É—Å–ø–µ—à–Ω—ã–π': '#2196F3', '–≤ –≥—Ä—É–ø–ø–µ —Ä–∏—Å–∫–∞': '#FF9800'}
    sizes = 80 + 20 * (—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã['–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å'] / 100)  # –†–∞–∑–º–µ—Ä —Ç–æ—á–∫–∏ = –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å

    for —Å—Ç–∞—Ç—É—Å in —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã['–°—Ç–∞—Ç—É—Å'].unique():
        subset = —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã[—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã['–°—Ç–∞—Ç—É—Å'] == —Å—Ç–∞—Ç—É—Å]
        axes[0, 1].scatter(subset['–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å'], subset['–û–ø–æ–∑–¥–∞–Ω–∏—è'],
                           c=—Ü–≤–µ—Ç–∞[—Å—Ç–∞—Ç—É—Å], label=—Å—Ç–∞—Ç—É—Å, s=sizes[subset.index],
                           alpha=0.8, edgecolors='black', linewidth=1)
    axes[0, 1].set_title("–û–ø–æ–∑–¥–∞–Ω–∏—è vs –ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å")
    axes[0, 1].set_xlabel("–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å (%)")
    axes[0, 1].set_ylabel("–û–ø–æ–∑–¥–∞–Ω–∏—è")
    axes[0, 1].legend()
    axes[0, 1].grid(True, alpha=0.3)

    # –ì—Ä–∞—Ñ–∏–∫ 3: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∏—Å—Ç–æ—Ä–∏–µ–π
    —Å—Ä–µ–¥–Ω–∏–µ_–Ω–æ–≤–æ–π_–≥—Ä—É–ø–ø—ã = —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã[['–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å', '–°—Ä. –æ—Ü–µ–Ω–∫–∞', '–û–ø–æ–∑–¥–∞–Ω–∏—è']].mean()
    —Å—Ä–µ–¥–Ω–∏–µ_–∏—Å—Ç–æ—Ä–∏–∏ = data[['–ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å', '—Å—Ä–µ–¥–Ω—è—è_–æ—Ü–µ–Ω–∫–∞', '–æ–ø–æ–∑–¥–∞–Ω–∏—è']].mean()

    –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ = ['–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å', '–°—Ä. –æ—Ü–µ–Ω–∫–∞', '–û–ø–æ–∑–¥–∞–Ω–∏—è']
    –Ω–æ–≤—ã–µ = [—Å—Ä–µ–¥–Ω–∏–µ_–Ω–æ–≤–æ–π_–≥—Ä—É–ø–ø—ã['–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å'],
             —Å—Ä–µ–¥–Ω–∏–µ_–Ω–æ–≤–æ–π_–≥—Ä—É–ø–ø—ã['–°—Ä. –æ—Ü–µ–Ω–∫–∞'],
             —Å—Ä–µ–¥–Ω–∏–µ_–Ω–æ–≤–æ–π_–≥—Ä—É–ø–ø—ã['–û–ø–æ–∑–¥–∞–Ω–∏—è']]
    –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ = [—Å—Ä–µ–¥–Ω–∏–µ_–∏—Å—Ç–æ—Ä–∏–∏['–ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å'],
                    —Å—Ä–µ–¥–Ω–∏–µ_–∏—Å—Ç–æ—Ä–∏–∏['—Å—Ä–µ–¥–Ω—è—è_–æ—Ü–µ–Ω–∫–∞'],
                    —Å—Ä–µ–¥–Ω–∏–µ_–∏—Å—Ç–æ—Ä–∏–∏['–æ–ø–æ–∑–¥–∞–Ω–∏—è']]

    x = np.arange(len(–ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏))
    width = 0.35
    axes[1, 0].bar(x - width/2, –Ω–æ–≤—ã–µ, width, label='–ù–æ–≤–∞—è –≥—Ä—É–ø–ø–∞', color='skyblue')
    axes[1, 0].bar(x + width/2, –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ, width, label='–ü—Ä–æ—à–ª—ã–µ —Å—Ç—É–¥–µ–Ω—Ç—ã', color='lightcoral')
    axes[1, 0].set_title("–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–æ —Å—Ä–µ–¥–Ω–∏–º–∏")
    axes[1, 0].set_xticks(x)
    axes[1, 0].set_xticklabels(–ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏)
    axes[1, 0].legend()
    axes[1, 0].grid(True, axis='y', alpha=0.3)

    # –ì—Ä–∞—Ñ–∏–∫ 4: –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ ‚Äî —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏
    corr_matrix = —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã[['–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å', '–°—Ä. –æ—Ü–µ–Ω–∫–∞', '–û–ø–æ–∑–¥–∞–Ω–∏—è', '–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å']].corr()
    sns.heatmap(corr_matrix, annot=True, cmap='coolwarm', center=0, ax=axes[1, 1], fmt=".2f")
    axes[1, 1].set_title("–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏")

    plt.tight_layout(rect=[0, 0, 1, 0.96])
    plt.show()

    # üìù –®–ê–ì 10: –í—ã–≤–æ–¥–∏–º –ø–æ–Ω—è—Ç–Ω—É—é —Å–≤–æ–¥–∫—É
    –≤_—Ä–∏—Å–∫–µ = (—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã['–°—Ç–∞—Ç—É—Å'] == '–≤ –≥—Ä—É–ø–ø–µ —Ä–∏—Å–∫–∞').sum()
    —Å—Ä–µ–¥–Ω—è—è_–ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å = —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã['–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å'].mean()
    —Å—Ä–µ–¥–Ω–µ–µ_–æ–ø–æ–∑–¥–∞–Ω–∏–π = —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã['–û–ø–æ–∑–¥–∞–Ω–∏—è'].mean()

    print(f"\nüìà –î–ò–ù–ê–ú–ò–ß–ï–°–ö–ê–Ø –°–í–û–î–ö–ê:")
    print(f"‚Ä¢ –í –≥—Ä—É–ø–ø–µ —Ä–∏—Å–∫–∞: {–≤_—Ä–∏—Å–∫–µ} –∏–∑ {n_new} ({–≤_—Ä–∏—Å–∫–µ / n_new:.1%})")
    print(f"‚Ä¢ –°—Ä–µ–¥–Ω—è—è –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å: {—Å—Ä–µ–¥–Ω—è—è_–ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å:.1f}%")
    print(f"‚Ä¢ –°—Ä–µ–¥–Ω–µ–µ –æ–ø–æ–∑–¥–∞–Ω–∏–π: {—Å—Ä–µ–¥–Ω–µ–µ_–æ–ø–æ–∑–¥–∞–Ω–∏–π:.1f}")

    if –≤_—Ä–∏—Å–∫–µ > 0:
        print(f"‚ö†Ô∏è  –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: –ø–æ–≥–æ–≤–æ—Ä–∏—Ç—å —Å {–≤_—Ä–∏—Å–∫–µ} —Å—Ç—É–¥–µ–Ω—Ç–æ–º(–∞–º–∏) –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ.")
    else:
        print("‚úÖ –û—Ç–ª–∏—á–Ω–æ: –≤—Å–µ —Å—Ç—É–¥–µ–Ω—Ç—ã –Ω–∞ —Ö–æ—Ä–æ—à–µ–º —É—Ä–æ–≤–Ω–µ!")

    if —Å—Ä–µ–¥–Ω–µ–µ_–æ–ø–æ–∑–¥–∞–Ω–∏–π > 4:
        print("üîî –í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –æ–ø–æ–∑–¥–∞–Ω–∏–π ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ, —Å—Ç–æ–∏—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ.")

except ValueError as e:
    print(f"‚ùå –û—à–∏–±–∫–∞ –≤–≤–æ–¥–∞: {e}")
except Exception as e:
    print(f"‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: {e}")
# –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ:
# - –í–≤–µ—Å—Ç–∏ 1 —Å—Ç—É–¥–µ–Ω—Ç–∞ –∏–ª–∏ 100
# - –£–≤–∏–¥–µ—Ç—å –ø—Ä–æ–≥–Ω–æ–∑
# - –ü–æ–ª—É—á–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏
# - –ü—Ä–∏–Ω—è—Ç—å —Ä–µ—à–µ–Ω–∏–µ